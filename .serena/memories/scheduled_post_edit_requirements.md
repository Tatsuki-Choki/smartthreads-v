# 予約投稿編集機能 要件定義書

## 1. 機能概要
予約投稿一覧画面から予約済みの投稿を編集できる機能を実装する。

## 2. 機能要件

### 2.1 編集可能項目
- 投稿内容（テキスト）
- 予約日時
- 投稿タイプ（通常投稿/ツリー投稿）
- ツリー投稿の場合は各投稿の内容

### 2.2 編集不可項目
- 投稿ID
- ワークスペースID
- Threadsアカウント
- 作成日時

### 2.3 制約事項
- 過去の日時への変更は不可
- 公開済み（published）の投稿は編集不可
- 失敗（failed）した投稿は編集不可
- 予約中（scheduled）の投稿のみ編集可能

## 3. UI/UX要件

### 3.1 編集フロー
1. 予約投稿一覧画面で「編集」ボタンをクリック
2. 編集ページ（/posts/scheduled/[id]/edit）へ遷移
3. 既存の投稿内容がフォームに表示される
4. 内容を編集
5. 「更新」ボタンで保存 or 「キャンセル」で破棄

### 3.2 画面構成
- 新規投稿画面と同じUIコンポーネントを再利用
- 初期値として既存データを設定
- タイトルは「予約投稿を編集」

## 4. API要件

### 4.1 取得API
- GET `/api/posts/[id]`
- 指定IDの投稿データを取得

### 4.2 更新API
- PATCH `/api/posts/[id]`
- 投稿内容と予約日時を更新

## 5. データベース要件
- 既存のpostsテーブルを使用
- updated_atカラムを自動更新

## 6. セキュリティ要件
- ワークスペースメンバーのみ編集可能
- RLSポリシーで権限チェック
- 他ワークスペースの投稿は編集不可

## 7. エラーハンドリング
- 過去日時エラー: 「予約日時は現在より未来を指定してください」
- 権限エラー: 「この投稿を編集する権限がありません」
- 存在しないID: 「投稿が見つかりません」

## 8. 実装ファイル構成

### 新規作成ファイル
1. `/app/(dashboard)/posts/scheduled/[id]/edit/page.tsx` - 編集ページ
2. `/app/api/posts/[id]/route.ts` - GET/PATCH API

### 修正ファイル
1. `/app/(dashboard)/posts/scheduled/page.tsx` - 編集ボタン追加
2. `/components/post-form.tsx` - 編集モード対応（既存データの初期表示）